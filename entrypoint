#!/bin/bash

# 启动 logrotate 并定时运行
while true; do
    /usr/sbin/logrotate /etc/logrotate.d/partialpathscanner
    sleep 10m
done &

# 如果宿主机的目录中没有配置文件，就从镜像中复制
if [ ! -f /config/config.yaml ]; then
    cp /template/config.yaml /config/config.yaml
fi
cp /template/config.yaml /config/config_template.yaml


# 运行 Python 脚本
touch /app/output.log
cd /app && python -u main.py | tee -a /app/output.log